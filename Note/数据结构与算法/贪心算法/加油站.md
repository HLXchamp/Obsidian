![[Pasted image 20240424120515.png]]
![[Pasted image 20240424120526.png|600]]

## 思路

### 暴力方法

暴力的方法很明显就是O(n^2)的，遍历每一个加油站为起点的情况，模拟一圈。如果跑了一圈，中途没有断油，而且最后油量大于等于0，说明这个起点是ok的。

**for循环适合模拟从头到尾的遍历，而while循环适合模拟环形遍历，要善于使用while！**

```java
public class Solution {
    public int canCompleteCircuit(int[] gas, int[] cost) {
        int n = gas.length;
        for (int i = 0; i < n; i++) {
            int rest = gas[i] - cost[i]; // 记录剩余油量
            int index = (i + 1) % n;
            while (rest >= 0 && index != i) { // 模拟以i为起点行驶一圈
                rest += gas[index] - cost[index];
                index = (index + 1) % n;
            }
            // 如果以i为起点跑一圈，剩余油量>=0，返回该起始位置
            if (rest >= 0 && index == i) {
                return i;
            }
        }
        return -1; // 无法完成一圈
    }
}
```

- 时间复杂度：O(n^2)
- 空间复杂度：O(1)

### 贪心算法

首先如果总油量减去总消耗大于等于零那么一定可以跑完一圈，说明 各个站点的加油站 剩油量`rest[i] = gas[i] - cost[i]`相加一定是大于等于零的。

i从0开始累加`rest[i]`，和记为curSum，一旦curSum小于零，说明`[0, i]`区间都不能作为起始位置，因为这个区间选择任何一个位置作为起点，到i这里都会断油，那么**起始位置从i+1算起**，再**从0计算curSum**。

![|325](https://code-thinking-1253855093.file.myqcloud.com/pics/20230117165628.png)

那有没有可能 `[0，i]` 区间 选某一个作为起点，累加到 i这里 curSum是不会小于零呢？ 如图：

![|450](https://code-thinking-1253855093.file.myqcloud.com/pics/20230117170703.png)

如果 curSum<0 说明 区间和1 + 区间和2 < 0， 那么 假设从上图中的位置开始计数curSum不会小于0的话，就是 区间和2>0。

区间和1 + 区间和2 < 0 同时 区间和2>0，只能说明区间和1 < 0， 那么就会从假设的箭头初就开始从新选择其实位置了。

**那么局部最优：当前累加`rest[i]`的和curSum一旦小于0，起始位置至少要是i+1，因为从i之前开始一定不行。全局最优：找到可以跑一圈的起始位置**。

局部最优可以推出全局最优，找不出反例，试试贪心！

```java
class Solution {
    public int canCompleteCircuit(int[] gas, int[] cost) {
        int totalSum = 0;
        int countSum = 0;
        int start = 0;
        for(int i = 0; i < gas.length; i++){
            countSum += (gas[i] - cost[i]);
            totalSum += (gas[i] - cost[i]);
            if(countSum < 0){
                start = i + 1;
                countSum = 0;
            }
        }
        if(totalSum < 0){
            return -1;
        }
        return start;
    }
}
```

- 时间复杂度：O(n)
- 空间复杂度：O(1)


