### 需求分析与设计

![[Pasted image 20240518204552.png]]

![[Pasted image 20240518204726.png|375]]

![[Pasted image 20240518204945.png|375]]

![[Pasted image 20240518205021.png]]

![[Pasted image 20240518205049.png|425]]

### 代码开发

新建一个ShopController：

```java
@RestController("adminShopController")  
@RequestMapping("/admin/shop")  
@Api(tags = "店铺相关接口")  
@Slf4j  
public class ShopController {  
  
    public static final String KEY = "SHOP_STATUS";  
  
    @Autowired  
    private RedisTemplate redisTemplate;  
  
    @PutMapping("/{status}")  
    @ApiOperation("设置店铺营业状态")  
    public Result setStatus(@PathVariable Integer status){  
        log.info("设置店铺营业状态：{}",status == 1 ? "营业中" : "打烊中");  
        redisTemplate.opsForValue().set(KEY, status);  
        return Result.success();  
    }  
  
    @GetMapping("/status")  
    @ApiOperation("查询店铺营业状态")  
    public Result<Integer> getStatus(){  
        Integer status = (Integer) redisTemplate.opsForValue().get(KEY);  
        log.info("获取到店铺的营业状态为：{}",status == 1 ? "营业中" : "打烊中");  
        return Result.success(status);  
    }  
}
```

SHOP_STATUS最好声明为常量。

同时创建一个user包，用于放用户端的controller接口，也创建一个ShopController，代码都是一样的：

![[Pasted image 20240518213641.png]]

但是两个相同的ShopController无法通过编译，原因是Bean容器里都是shopController，无法区分，这时在对应@RestController后面加上具体名称就好！

在WebMvcConfiguration配置类可以分别配置用户端和管理端接口文档，groupName表示这一类接口名称：

```java
/**  
 * 通过knife4j生成接口文档  
 * @return  
 */  
@Bean  
public Docket docket1() {  
    log.info("准备生成接口文档...");  
    ApiInfo apiInfo = new ApiInfoBuilder()  
            .title("苍穹外卖项目接口文档")  
            .version("2.0")  
            .description("苍穹外卖项目接口文档")  
            .build();  
    Docket docket = new Docket(DocumentationType.SWAGGER_2)  
            .groupName("管理端接口")  
            .apiInfo(apiInfo)  
            .select()  
            .apis(RequestHandlerSelectors.basePackage("com.sky.controller.admin"))  
            .paths(PathSelectors.any())  
            .build();  
    return docket;  
}  
  
@Bean  
public Docket docket2() {  
    log.info("准备生成接口文档...");  
    ApiInfo apiInfo = new ApiInfoBuilder()  
            .title("苍穹外卖项目接口文档")  
            .version("2.0")  
            .description("苍穹外卖项目接口文档")  
            .build();  
    Docket docket = new Docket(DocumentationType.SWAGGER_2)  
            .groupName("用户端接口")  
            .apiInfo(apiInfo)  
            .select()  
            .apis(RequestHandlerSelectors.basePackage("com.sky.controller.user"))  
            .paths(PathSelectors.any())  
            .build();  
    return docket;  
}
```
